class ConfirmRequestHeaders
  def call(env)
    headers = env.select { |k, _v| k.start_with?('HTTP_') }
                 .map { |k, v| [k.sub(/^HTTP_/, ''), v] }
                 .to_h

    headers_list = headers.select { |k, _v| k.include?('X') }
                          .map { |k, v| "#{k}: #{v}" }.join("\n")

    [200, { 'Content-Type' => 'text/plain' }, ["#{headers_list}"]]
  end
end

run ConfirmRequestHeaders.new
